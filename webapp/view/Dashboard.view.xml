<mvc:View controllerName="ehsmportal.controller.Dashboard"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m">
    <Page id="dashboardPage" title="Dashboard" showNavButton="true" navButtonPress=".onLogout">
        <headerContent>
            <Button text="Logout" press=".onLogout" type="Transparent" tooltip="Logout"/>
        </headerContent>
        <content>
            <FlexBox wrap="Wrap" justifyContent="Center" class="sapUiSmallMargin">
                <GenericTile class="sapUiSmallMargin" header="Incident Management" subheader="Manage Incidents" press=".onPressIncident" frameType="TwoByOne">
                    <TileContent>
                        <ImageContent src="sap-icon://alert" />
                    </TileContent>
                </GenericTile>
                <GenericTile class="sapUiSmallMargin" header="Risk Assessment" subheader="Analyze Risks" press=".onPressRisk" frameType="TwoByOne">
                    <TileContent>
                        <ImageContent src="sap-icon://quality-issue" />
                    </TileContent>
                </GenericTile>
            </FlexBox>
            
            <Panel headerText="Recent Incidents" class="sapUiMediumMargin">
                <List id="incidentsList" 
                      items="{
                        path: '/ZRD_EHSM_INCIDENTSet',
                        sorter: { path: 'IncidentDate', descending: true }
                      }"
                      noDataText="No incidents found">
                    <StandardListItem 
                        title="{IncidentDescription}" 
                        description="{IncidentPriority} - {IncidentStatus}" 
                        info="{IncidentDate}" 
                        icon="sap-icon://alert"
                        infoState="{= ${IncidentPriority} === 'High' ? 'Error' : ${IncidentPriority} === 'Medium' ? 'Warning' : 'Success' }"/>
                </List>
            </Panel>
        </content>
    </Page>
</mvc:View>
